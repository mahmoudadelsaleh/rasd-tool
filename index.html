<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ù†Ø¸ÙˆÙ…Ø© Ø§Ù„Ø±ØµØ¯ - ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</title>

<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>

<style>
body{
font-family:Segoe UI;
background:#1e293b;
display:flex;
align-items:center;
justify-content:center;
height:100vh;
margin:0;
}
.card{
background:white;
padding:30px;
border-radius:20px;
width:90%;
max-width:380px;
text-align:center;
box-shadow:0 10px 30px rgba(0,0,0,.3);
}
input{
width:100%;
padding:12px;
margin:8px 0;
border-radius:10px;
border:1px solid #ddd;
box-sizing:border-box;
}
input:focus{outline:2px solid #3b82f6;outline-offset:2px;}
button{
width:100%;
padding:12px;
border:none;
border-radius:10px;
background:#3b82f6;
color:white;
font-weight:bold;
cursor:pointer;
transition:.2s;
}
button:active{transform:scale(.98);}
button:disabled{opacity:.7;cursor:not-allowed;}
.error{
color:#ef4444;
font-size:13px;
margin-top:10px;
display:none;
}
.remember{
display:flex;
align-items:center;
gap:5px;
margin:10px 0;
font-size:14px;
color:#475569;
cursor:pointer;
}
</style>
</head>
<body>

<div class="card">
<div style="font-size:50px;margin-bottom:5px;">ğŸ“Š</div>
<h2 style="margin-top:0;">Ù…Ù†Ø¸ÙˆÙ…Ø© Ø§Ù„Ø±ØµØ¯</h2>
<input type="text" id="user" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" autocomplete="off">
<input type="password" id="pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
<label class="remember">
    <input type="checkbox" id="remember"> ØªØ°ÙƒØ±Ù†ÙŠ
</label>
<button id="loginBtn" onclick="handleLogin()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
<div id="err" class="error"></div>
</div>

<script>
const firebaseConfig={
apiKey:"AIzaSyBePGZiqMPmZQdg36jZ4Rkdtd7OISxmob8",
projectId:"rasd-tools"
};
firebase.initializeApp(firebaseConfig);
const db=firebase.firestore();

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¬Ù„Ø³Ø© Ù…Ø­ÙÙˆØ¸Ø©
const savedUser = localStorage.getItem("userEmail");
if(savedUser) {
    if(localStorage.getItem("isAdmin") === "true") {
        sessionStorage.setItem("userEmail", savedUser);
        sessionStorage.setItem("isAdmin", "true");
        location.href = "admin.html";
    } else {
        sessionStorage.setItem("userEmail", savedUser);
        location.href = "teacher.html";
    }
}

async function handleLogin(){
const u=user.value.trim();
const p=pass.value.trim();
const rememberMe = document.getElementById('remember').checked;

if(!u||!p)return;

loginBtn.disabled=true;
loginBtn.innerText="Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...";
err.style.display="none";

// ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ø¯Ù…Ù†
if(u==="admin"&&p==="790707071"){
    sessionStorage.setItem("userEmail","admin");
    sessionStorage.setItem("isAdmin","true");
    
    if(rememberMe) {
        localStorage.setItem("userEmail", "admin");
        localStorage.setItem("isAdmin", "true");
    }
    
    location.href="admin.html";
    return;
}

// ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ†
try{
    const doc=await db.collection("teachers").doc(u).get();
    
    if(!doc.exists){
        showError("Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯");
        return;
    }
    
    if(doc.data().pass!==p){
        showError("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©");
        return;
    }

    sessionStorage.setItem("userEmail",u);
    sessionStorage.removeItem("isAdmin");
    
    if(rememberMe) {
        localStorage.setItem("userEmail", u);
        localStorage.removeItem("isAdmin");
    }
    
    location.href="teacher.html";

}catch(e){
    showError("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„");
}
}

function showError(msg){
err.innerText=msg;
err.style.display="block";
loginBtn.disabled=false;
loginBtn.innerText="ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„";
}
</script>

</body>
</html>